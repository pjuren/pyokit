<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Sequence Alignments &mdash; Pyokit 0.2.0 documentation</title>
    
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.2.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="Pyokit 0.2.0 documentation" href="index.html" />
    <link rel="up" title="Using Pyokit" href="using.html" />
    <link rel="next" title="Retrotransposons" href="retrotransposons.html" />
    <link rel="prev" title="Biological Sequences" href="sequences.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="retrotransposons.html" title="Retrotransposons"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="sequences.html" title="Biological Sequences"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Pyokit 0.2.0 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="using.html" accesskey="U">Using Pyokit</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="sequence-alignments">
<h1>Sequence Alignments<a class="headerlink" href="#sequence-alignments" title="Permalink to this headline">¶</a></h1>
<p>At present, pyokit has support only for pairwise alignments; multiple sequence
alignment support is coming soon.</p>
<div class="section" id="pairwise-alignments">
<h2>Pairwise alignments<a class="headerlink" href="#pairwise-alignments" title="Permalink to this headline">¶</a></h2>
<p>Pairwise alignments are represented by the PairwiseAlignment class; the full
documentation for this class is given in <a class="reference internal" href="datastrct.html#pairwisealignmentclasssection"><span>The PairwiseAlignment class</span></a>.
Briefly, objects of this class store the actual sequence data of the two
component sequences, as well as a range of meta-data stored as key-value pairs.
Construction is fairly straighforward</p>
<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">pyokit.datastruct.multipleAlignment.</code><code class="descname">PairwiseAlignment</code><span class="sig-paren">(</span><em>s1</em>, <em>s2</em>, <em>meta_data=None</em><span class="sig-paren">)</span></dt>
<dd><p>An alignment of two sequences (DNA, RNA, protein...).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>s1</strong> &#8211; the first sequence, with gaps</li>
<li><strong>s2</strong> &#8211; the second sequence, with gaps</li>
<li><strong>meta_data</strong> &#8211; a dictionary with key-value pairs representing meta-data
about this alignment.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<div class="section" id="pairwise-alignment-meta-data">
<h3>Pairwise Alignment Meta-data<a class="headerlink" href="#pairwise-alignment-meta-data" title="Permalink to this headline">¶</a></h3>
<p>The class attaches meaning to a number of keys-value pairs that can be included
in the meta-data dictionary. Certain keys have special meaning &#8211; these are
used for various things, including (and probably mostly, at least for now)
formatting the alignment for display. None of these strictly need to be defined
in the meta-data dictionary, although some might be required for producing
certain string representations. These known keys can be broken into related
groups. Firstly, there are those that store the names and co-ordinates of the
two sequences.</p>
<dl class="data">
<dt id="pyokit.datastruct.multipleAlignment.S1_NAME_KEY">
<code class="descclassname">pyokit.datastruct.multipleAlignment.</code><code class="descname">S1_NAME_KEY</code><em class="property"> = 's1_name'</em><a class="headerlink" href="#pyokit.datastruct.multipleAlignment.S1_NAME_KEY" title="Permalink to this definition">¶</a></dt>
<dd><p>name of the first sequence</p>
</dd></dl>

<dl class="data">
<dt id="pyokit.datastruct.multipleAlignment.S2_NAME_KEY">
<code class="descclassname">pyokit.datastruct.multipleAlignment.</code><code class="descname">S2_NAME_KEY</code><em class="property"> = 's2_name'</em><a class="headerlink" href="#pyokit.datastruct.multipleAlignment.S2_NAME_KEY" title="Permalink to this definition">¶</a></dt>
<dd><p>name of the second sequence</p>
</dd></dl>

<dl class="data">
<dt id="pyokit.datastruct.multipleAlignment.S1_START_KEY">
<code class="descclassname">pyokit.datastruct.multipleAlignment.</code><code class="descname">S1_START_KEY</code><em class="property"> = 's1_start_coord'</em><a class="headerlink" href="#pyokit.datastruct.multipleAlignment.S1_START_KEY" title="Permalink to this definition">¶</a></dt>
<dd><p>start co-ordinate of the first sequence</p>
</dd></dl>

<dl class="data">
<dt id="pyokit.datastruct.multipleAlignment.S2_START_KEY">
<code class="descclassname">pyokit.datastruct.multipleAlignment.</code><code class="descname">S2_START_KEY</code><em class="property"> = 's2_start_coord'</em><a class="headerlink" href="#pyokit.datastruct.multipleAlignment.S2_START_KEY" title="Permalink to this definition">¶</a></dt>
<dd><p>start co-ordinate of the second sequence</p>
</dd></dl>

<dl class="data">
<dt id="pyokit.datastruct.multipleAlignment.S1_END_KEY">
<code class="descclassname">pyokit.datastruct.multipleAlignment.</code><code class="descname">S1_END_KEY</code><em class="property"> = 's1_end_coord'</em><a class="headerlink" href="#pyokit.datastruct.multipleAlignment.S1_END_KEY" title="Permalink to this definition">¶</a></dt>
<dd><p>end co-ordinate of the first sequence</p>
</dd></dl>

<dl class="data">
<dt id="pyokit.datastruct.multipleAlignment.S2_END_KEY">
<code class="descclassname">pyokit.datastruct.multipleAlignment.</code><code class="descname">S2_END_KEY</code><em class="property"> = 's2_end_coord'</em><a class="headerlink" href="#pyokit.datastruct.multipleAlignment.S2_END_KEY" title="Permalink to this definition">¶</a></dt>
<dd><p>end co-ordinate of the second sequence</p>
</dd></dl>

<dl class="data">
<dt id="pyokit.datastruct.multipleAlignment.S1_START_NEG_STRAND_KEY">
<code class="descclassname">pyokit.datastruct.multipleAlignment.</code><code class="descname">S1_START_NEG_STRAND_KEY</code><em class="property"> = 's1_start_neg_coord'</em><a class="headerlink" href="#pyokit.datastruct.multipleAlignment.S1_START_NEG_STRAND_KEY" title="Permalink to this definition">¶</a></dt>
<dd><p>start co-ordinate of the first sequenc in negative strand co-ordinates</p>
</dd></dl>

<dl class="data">
<dt id="pyokit.datastruct.multipleAlignment.S2_START_NEG_STRAND_KEY">
<code class="descclassname">pyokit.datastruct.multipleAlignment.</code><code class="descname">S2_START_NEG_STRAND_KEY</code><em class="property"> = 's2_start_neg_coord'</em><a class="headerlink" href="#pyokit.datastruct.multipleAlignment.S2_START_NEG_STRAND_KEY" title="Permalink to this definition">¶</a></dt>
<dd><p>start co-ordinate of the second sequenc in negative strand co-ordinates</p>
</dd></dl>

<dl class="data">
<dt id="pyokit.datastruct.multipleAlignment.S1_END_NEG_STRAND_KEY">
<code class="descclassname">pyokit.datastruct.multipleAlignment.</code><code class="descname">S1_END_NEG_STRAND_KEY</code><em class="property"> = 's1_end_neg_coord'</em><a class="headerlink" href="#pyokit.datastruct.multipleAlignment.S1_END_NEG_STRAND_KEY" title="Permalink to this definition">¶</a></dt>
<dd><p>end co-ordinate of the first sequenc in negative strand co-ordinates</p>
</dd></dl>

<dl class="data">
<dt id="pyokit.datastruct.multipleAlignment.S2_END_NEG_STRAND_KEY">
<code class="descclassname">pyokit.datastruct.multipleAlignment.</code><code class="descname">S2_END_NEG_STRAND_KEY</code><em class="property"> = 's2_end_neg_coord'</em><a class="headerlink" href="#pyokit.datastruct.multipleAlignment.S2_END_NEG_STRAND_KEY" title="Permalink to this definition">¶</a></dt>
<dd><p>end co-ordinate of the second sequenc in negative strand co-ordinates</p>
</dd></dl>

<p>Then there are keys that index data about the alignment itself</p>
<dl class="data">
<dt id="pyokit.datastruct.multipleAlignment.ALIG_SCORE_KEY">
<code class="descclassname">pyokit.datastruct.multipleAlignment.</code><code class="descname">ALIG_SCORE_KEY</code><em class="property"> = 'alig_score'</em><a class="headerlink" href="#pyokit.datastruct.multipleAlignment.ALIG_SCORE_KEY" title="Permalink to this definition">¶</a></dt>
<dd><p>score for the alignment; no requirement on how this is computed.</p>
</dd></dl>

<dl class="data">
<dt id="pyokit.datastruct.multipleAlignment.ANNOTATION_KEY">
<code class="descclassname">pyokit.datastruct.multipleAlignment.</code><code class="descname">ANNOTATION_KEY</code><em class="property"> = 'annotation'</em><a class="headerlink" href="#pyokit.datastruct.multipleAlignment.ANNOTATION_KEY" title="Permalink to this definition">¶</a></dt>
<dd><p>annotation for each column of the alignment; no requirements on format.</p>
</dd></dl>

<dl class="data">
<dt id="pyokit.datastruct.multipleAlignment.PCENT_S1_INDELS_KEY">
<code class="descclassname">pyokit.datastruct.multipleAlignment.</code><code class="descname">PCENT_S1_INDELS_KEY</code><em class="property"> = 'pcnt_s1_indels'</em><a class="headerlink" href="#pyokit.datastruct.multipleAlignment.PCENT_S1_INDELS_KEY" title="Permalink to this definition">¶</a></dt>
<dd><p>the percentage of the first sequence which is gaps. This is not computed
from the sequence itself, so may not be accurate.</p>
</dd></dl>

<dl class="data">
<dt id="pyokit.datastruct.multipleAlignment.PCENT_S2_INDELS_KEY">
<code class="descclassname">pyokit.datastruct.multipleAlignment.</code><code class="descname">PCENT_S2_INDELS_KEY</code><em class="property"> = 'pcnt_s2_indels'</em><a class="headerlink" href="#pyokit.datastruct.multipleAlignment.PCENT_S2_INDELS_KEY" title="Permalink to this definition">¶</a></dt>
<dd><p>the percentage of the second sequence which is gaps. This is not computed
from the sequence itself, so may not be accurate.</p>
</dd></dl>

<p>Some are specific to pairwise alignments generated by repeat-masker</p>
<dl class="data">
<dt id="pyokit.datastruct.multipleAlignment.UNKNOWN_RM_HEADER_FIELD_KEY">
<code class="descclassname">pyokit.datastruct.multipleAlignment.</code><code class="descname">UNKNOWN_RM_HEADER_FIELD_KEY</code><em class="property"> = 'unknown_rm_header_field'</em><a class="headerlink" href="#pyokit.datastruct.multipleAlignment.UNKNOWN_RM_HEADER_FIELD_KEY" title="Permalink to this definition">¶</a></dt>
<dd><p>If this is a repeat-masker alignment, this stores the value of the
second-last token from the header of the alignment; its meaning is unknown.</p>
</dd></dl>

<dl class="data">
<dt id="pyokit.datastruct.multipleAlignment.RM_ID_KEY">
<code class="descclassname">pyokit.datastruct.multipleAlignment.</code><code class="descname">RM_ID_KEY</code><em class="property"> = 'rm_id'</em><a class="headerlink" href="#pyokit.datastruct.multipleAlignment.RM_ID_KEY" title="Permalink to this definition">¶</a></dt>
<dd><p>If this is a repeat-masker alignment, this stores the unique ID assigned
to it by repeat-masker</p>
</dd></dl>

<p>Finally, there is a set containing all of the values</p>
<dl class="data">
<dt id="pyokit.datastruct.multipleAlignment.KNOWN_KEYS">
<code class="descclassname">pyokit.datastruct.multipleAlignment.</code><code class="descname">KNOWN_KEYS</code><em class="property"> = set(['s1_end_coord', 's2_start_neg_coord', 's2_rev_comp', 'pcnt_s2_indels', 's1_start_coord', 's2_end_neg_coord', 'rm_id', 'pcnt_subs', 's1_start_neg_coord', 's2_name', 's2_end_coord', 'unknown_rm_header_field', 's1_name', 's1_rev_comp', 'alig_score', 's2_start_coord', 's1_end_neg_coord', 'annotation', 'pcnt_s1_indels'])</em><a class="headerlink" href="#pyokit.datastruct.multipleAlignment.KNOWN_KEYS" title="Permalink to this definition">¶</a></dt>
<dd><p>The full set of meta-data keys that have special meaning</p>
</dd></dl>

<p>Other meta-data can be stored in the dictionary as needed, but won&#8217;t be
used by the class.</p>
</div>
<div class="section" id="reading-and-writing-pairwise-alignments">
<span id="readwritealignmentssection"></span><h3>Reading and writing pairwise alignments<a class="headerlink" href="#reading-and-writing-pairwise-alignments" title="Permalink to this headline">¶</a></h3>
<p>At present, there is only one iterator for reading pariwise alignments: one
for repeat-masker alignments. This is the documentation for the iterator,
which describes the format, and the header-parsing function, which describes
the header format and mapping between the header columns and the above
meta-data keys.</p>
<dl class="function">
<dt id="pyokit.io.alignmentIterators.repeat_masker_alignment_iterator">
<code class="descclassname">pyokit.io.alignmentIterators.</code><code class="descname">repeat_masker_alignment_iterator</code><span class="sig-paren">(</span><em>fn</em>, <em>index_friendly=True</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pyokit.io.alignmentIterators.repeat_masker_alignment_iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over a file/stream of full repeat alignments in the repeatmasker
format. Briefly, this format is as follows: each record (alignment) begins
with a header line (see _rm_parse_header_line documentation for details of
header format), followed by the alignment itself (example below) and finally
a set of key-value meta-data pairs.</p>
<p>The actual alignment looks like this:</p>
<div class="highlight-python"><div class="highlight"><pre>chr1               11 CCCTGGAGATTCTTATT--AGTGATTTGGGCT 41
                         ii        v   -- v  i i    v
C MER5B#DNA/hAT    10 CCCCAGAGATTCTGATTTAATTGGTCTGGGGT 42

chr1               42 GACTG 47
                       v
C MER5B#DNA/hAT    43 CACTG 48
</pre></div>
</div>
<p>The &#8216;C&#8217; indicates that its the reverse complement of the consensus. The
central string gives information about matches; &#8220;-&#8221; indicates an
insertion/deletion, &#8220;i&#8221; a transition (G&lt;-&gt;A, C&lt;-&gt;T) and &#8220;v&#8221; a transversion
(all other substitutions).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>fh</strong> &#8211; filename or stream-like object to read from.</li>
<li><strong>index_friendly</strong> &#8211; if True, we will ensure the file/stream
position is before the start of the record when we
yield it; this requires the ability to seek within
the stream though, so if iterating over a
stream wtihout that ability, you&#8217;ll have to set this
to false. Further, this will disable buffering for
the file, to ensure file.tell() behaves correctly,
so a performance hit will be incurred.</li>
<li><strong>verbose</strong> &#8211; if true, output progress messages to stderr.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyokit.io.alignmentIterators._rm_parse_header_line">
<code class="descclassname">pyokit.io.alignmentIterators.</code><code class="descname">_rm_parse_header_line</code><span class="sig-paren">(</span><em>parts</em>, <em>meta_data</em><span class="sig-paren">)</span><a class="headerlink" href="#pyokit.io.alignmentIterators._rm_parse_header_line" title="Permalink to this definition">¶</a></dt>
<dd><p>parse a repeatmasker alignment header line and place the extracted meta-data
into the provided dictionary. An example header line is:</p>
<div class="highlight-python"><div class="highlight"><pre>239 29.42 1.92 0.97 chr1 11 17 (41) C XX#YY (74) 104 1 m_b1s502i1 4
</pre></div>
</div>
<p>If the alignment is to the consensus, this will have 14 fields; to the
reverse complement of the repeat consensus and it&#8217;ll have 15. Fields as
follows:</p>
<table border="1" class="docutils">
<colgroup>
<col width="7%" />
<col width="11%" />
<col width="82%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Num</th>
<th class="head">Value</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0</td>
<td>239</td>
<td>Smith-Waterman score of the match</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>29.42</td>
<td>percent substitutions in match compared to the consensus</td>
</tr>
<tr class="row-even"><td>2</td>
<td>1.92</td>
<td>percent bases opposite gap in query seq (deleted bp)</td>
</tr>
<tr class="row-odd"><td>3</td>
<td>0.97</td>
<td>percent bases opposite gap in repeat consensus (insert bp)</td>
</tr>
<tr class="row-even"><td>4</td>
<td>chr1</td>
<td>The name of the reference sequence (usually genomic chrom)</td>
</tr>
<tr class="row-odd"><td>5</td>
<td>11</td>
<td>Start location in reference; always pos strand, I think..</td>
</tr>
<tr class="row-even"><td>6</td>
<td>17</td>
<td>End location in reference; always pos strand, I think..</td>
</tr>
<tr class="row-odd"><td>7</td>
<td><ol class="first last arabic simple" start="41">
<li></li>
</ol>
</td>
<td>Distance to end of ref (alt., neg strand co-ord of end)</td>
</tr>
<tr class="row-even"><td>8</td>
<td>C</td>
<td>Alignment is to rev. comp. of consensus. Ommited otherwise</td>
</tr>
<tr class="row-odd"><td>8/9</td>
<td>XX#YY</td>
<td>XX is the name of the repeat and YY is the family</td>
</tr>
<tr class="row-even"><td>9/10</td>
<td><ol class="first last arabic simple" start="74">
<li></li>
</ol>
</td>
<td>if +&#8217;ve, strt coord; else bases before start on neg strand</td>
</tr>
<tr class="row-odd"><td>10/11</td>
<td>104</td>
<td>if +&#8217;ve, end coord; else start of match in pos strand</td>
</tr>
<tr class="row-even"><td>11/12</td>
<td>1</td>
<td>if +&#8217;ve, num bases aftr mtch to end; else end in + coords</td>
</tr>
<tr class="row-odd"><td>12/13</td>
<td>m_b1s5..</td>
<td>....?</td>
</tr>
<tr class="row-even"><td>13/14</td>
<td>4</td>
<td>unique ID</td>
</tr>
</tbody>
</table>
<p>Each field is mapped to a key as follows</p>
<table border="1" class="docutils">
<colgroup>
<col width="7%" />
<col width="93%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Num</th>
<th class="head">Key (these are defined in pyokit.datastruct.multipleAlignment.py)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0</td>
<td>ALIG_SCORE_KEY</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>PCENT_SUBS_KEY</td>
</tr>
<tr class="row-even"><td>2</td>
<td>PCENT_S1_INDELS_KEY</td>
</tr>
<tr class="row-odd"><td>3</td>
<td>PCENT_S2_INDELS_KEY</td>
</tr>
<tr class="row-even"><td>4</td>
<td>S1_NAME_KEY</td>
</tr>
<tr class="row-odd"><td>5</td>
<td>S1_START_KEY</td>
</tr>
<tr class="row-even"><td>6</td>
<td>S1_END_KEY</td>
</tr>
<tr class="row-odd"><td>7</td>
<td>S1_END_NEG_STRAND_KEY</td>
</tr>
<tr class="row-even"><td>8</td>
<td>S2_REVERSE_COMP_KEY</td>
</tr>
<tr class="row-odd"><td>8/9</td>
<td>S2_NAME_KEY</td>
</tr>
<tr class="row-even"><td>9/10</td>
<td>S2_START_KEY (S2 + strand) / S2_START_NEG_STRAND_KEY (S2 - strand)</td>
</tr>
<tr class="row-odd"><td>10/11</td>
<td>S2_END_KEY (S2 + strand) / S2_START_KEY (S2 - strand)</td>
</tr>
<tr class="row-even"><td>11/12</td>
<td>S2_END_NEG_STRAND_KEY (S2 + strand) / S2_END_KEY (S2 - strand)</td>
</tr>
<tr class="row-odd"><td>12/13</td>
<td>UNKNOWN_RM_HEADER_FIELD_KEY</td>
</tr>
<tr class="row-even"><td>13/14</td>
<td>RM_ID_KEY</td>
</tr>
</tbody>
</table>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>parts</strong> &#8211; the header line, as a tokenized list.</li>
<li><strong>meta_data</strong> &#8211; dictionary; resultant key-value pairs placed into this.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>Here is an example of a simple program that counts the number of alignments
in a repeat-masker alignment file</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyokit.io.alignmentIterators</span> <span class="kn">import</span> <span class="n">repeat_masker_alignment_iterator</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#from pyokit.datastruct import multipleAlignment</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alig_2_header</span> <span class="o">=</span> <span class="s">&quot;318 22.50 3.61 0.00 chr1 15266 15323 (249235276) C &quot;</span> <span class="o">+</span>\
<span class="gp">&gt;&gt;&gt; </span>                <span class="s">&quot;MIR3#SINE/MIR (65) 143 84 m_b1s601i1 5&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alig_2</span> <span class="o">=</span> <span class="s">&quot;  chr1          15266 GAAACT--GGCCCAGAGAGGTGAGGCAGCG 15293 </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>\
<span class="gp">&gt;&gt;&gt; </span>         <span class="s">&quot;                            --               i iii         </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>\
<span class="gp">&gt;&gt;&gt; </span>         <span class="s">&quot;C MIR3#SINE/MIR   143 GAAACTGAGGCCCAGAGAGGTGAAGTGACG 114   </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>\
<span class="gp">&gt;&gt;&gt; </span>         <span class="s">&quot;                                                           </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>\
<span class="gp">&gt;&gt;&gt; </span>         <span class="s">&quot;  chr1          15294 GGTCACAGAGCAAGGCAAAAGCGCGCTGGG 15323 </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>\
<span class="gp">&gt;&gt;&gt; </span>         <span class="s">&quot;                             v   ?  vi ivi    v            </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>\
<span class="gp">&gt;&gt;&gt; </span>         <span class="s">&quot;C MIR3#SINE/MIR   113 GGTCACACAGCKAGTTAGTGGCGAGCTGGG 84&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alig_2_m</span> <span class="o">=</span> <span class="s">&quot;Matrix = 25p47g.matrix                                   </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>\
<span class="gp">&gt;&gt;&gt; </span>           <span class="s">&quot;Kimura (with divCpGMod) = 26.25                          </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>\
<span class="gp">&gt;&gt;&gt; </span>           <span class="s">&quot;Transitions / transversions = 2.40 (12/5)                </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>\
<span class="gp">&gt;&gt;&gt; </span>           <span class="s">&quot;Gap_init rate = 0.03 (2 / 79), avg. gap size = 1.50 (3 / 2)&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alig_3_header</span> <span class="o">=</span> <span class="s">&quot;18 23.18 0.00 1.96 chr1 15798 15830 (249234772) &quot;</span> <span class="o">+</span>\
<span class="gp">&gt;&gt;&gt; </span>                <span class="s">&quot;(TGCTCC)n#Simple_repeat 1 32 (0) m_b1s252i0 6&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alig_3</span> <span class="o">=</span> <span class="s">&quot;  chr1          15798 GCTGCTTCTCCAGCTTTCGCTCCTTCATGCT 15828  </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>\
<span class="gp">&gt;&gt;&gt; </span>         <span class="s">&quot;                         v  v    v   iii      v - v          </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>\
<span class="gp">&gt;&gt;&gt; </span>         <span class="s">&quot;  (TGCTCC)n#Sim     1 GCTCCTGCTCCTGCTCCTGCTCCTGC-TCCT 30     </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>\
<span class="gp">&gt;&gt;&gt; </span>         <span class="s">&quot;                                                             </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>\
<span class="gp">&gt;&gt;&gt; </span>         <span class="s">&quot;  chr1          15829 GC 15830                               </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>\
<span class="gp">&gt;&gt;&gt; </span>         <span class="s">&quot;                                                             </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>\
<span class="gp">&gt;&gt;&gt; </span>         <span class="s">&quot;  (TGCTCC)n#Sim    31 GC 32                                    &quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">records</span> <span class="o">=</span> <span class="p">[</span><span class="n">alig_2_header</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="n">alig_2</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="n">alig_2_m</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>          <span class="n">alig_3_header</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="n">alig_3</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="n">alig_3_m</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_d</span> <span class="o">=</span> <span class="s">&quot;</span><span class="se">\n\n</span><span class="s">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">records</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span>
<span class="gp">&gt;&gt;&gt; </span>           <span class="n">repeat_masker_alignment_iterator</span><span class="p">(</span><span class="n">StringIO</span><span class="o">.</span><span class="n">StringIO</span><span class="p">(</span><span class="n">input_d</span><span class="p">))]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Sequence Alignments</a><ul>
<li><a class="reference internal" href="#pairwise-alignments">Pairwise alignments</a><ul>
<li><a class="reference internal" href="#pairwise-alignment-meta-data">Pairwise Alignment Meta-data</a></li>
<li><a class="reference internal" href="#reading-and-writing-pairwise-alignments">Reading and writing pairwise alignments</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="sequences.html"
                        title="previous chapter">Biological Sequences</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="retrotransposons.html"
                        title="next chapter">Retrotransposons</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/sequence_alignments.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="retrotransposons.html" title="Retrotransposons"
             >next</a> |</li>
        <li class="right" >
          <a href="sequences.html" title="Biological Sequences"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Pyokit 0.2.0 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="using.html" >Using Pyokit</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2014, Philip J. Uren.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Sequence Alignments &mdash; Pyokit 0.2.0 documentation</title>
    
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.2.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="Pyokit 0.2.0 documentation" href="index.html" />
    <link rel="up" title="Using Pyokit" href="using.html" />
    <link rel="next" title="Retrotransposons" href="retrotransposons.html" />
    <link rel="prev" title="Biological Sequences" href="sequences.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="retrotransposons.html" title="Retrotransposons"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="sequences.html" title="Biological Sequences"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Pyokit 0.2.0 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="using.html" accesskey="U">Using Pyokit</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="sequence-alignments">
<h1>Sequence Alignments<a class="headerlink" href="#sequence-alignments" title="Permalink to this headline">¶</a></h1>
<p>At present, pyokit has support only for pairwise alignments; multiple sequence
alignment support is coming soon.</p>
<div class="section" id="pairwise-alignments">
<h2>Pairwise alignments<a class="headerlink" href="#pairwise-alignments" title="Permalink to this headline">¶</a></h2>
<p>Pairwise alignments are represented by the PairwiseAlignment class; the full
documentation for this class is given in <a class="reference internal" href="datastrct.html#pairwisealignmentclasssection"><span>The PairwiseAlignment class</span></a>.
Briefly, objects of this class store the actual sequence data of the two
component sequences, as well as a range of meta-data stored as key-value pairs.
Construction is fairly straighforward</p>
<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">pyokit.datastruct.multipleAlignment.</code><code class="descname">PairwiseAlignment</code><span class="sig-paren">(</span><em>s1</em>, <em>s2</em>, <em>meta_data=None</em><span class="sig-paren">)</span></dt>
<dd><p>An alignment of two sequences (DNA, RNA, protein...).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>s1</strong> &#8211; the first sequence, with gaps</li>
<li><strong>s2</strong> &#8211; the second sequence, with gaps</li>
<li><strong>meta_data</strong> &#8211; a dictionary with key-value pairs representing meta-data
about this alignment.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<div class="section" id="pairwise-alignment-meta-data">
<h3>Pairwise Alignment Meta-data<a class="headerlink" href="#pairwise-alignment-meta-data" title="Permalink to this headline">¶</a></h3>
<p>The class attaches meaning to a number of keys-value pairs that can be included
in the meta-data dictionary. Certain keys have special meaning &#8211; these are
used for various things, including (and probably mostly, at least for now)
formatting the alignment for display. None of these strictly need to be defined
in the meta-data dictionary, although some might be required for producing
certain string representations. These known keys can be broken into related
groups. Firstly, there are those that store the names and co-ordinates of the
two sequences.</p>
<p>Then there are keys that index data about the alignment itself</p>
<p>Some are specific to pairwise alignments generated by repeat-masker</p>
<p>Finally, there is a set containing all of the values</p>
<p>Other meta-data can be stored in the dictionary as needed, but won&#8217;t be
used by the class.</p>
</div>
<div class="section" id="reading-and-writing-pairwise-alignments">
<span id="readwritealignmentssection"></span><h3>Reading and writing pairwise alignments<a class="headerlink" href="#reading-and-writing-pairwise-alignments" title="Permalink to this headline">¶</a></h3>
<p>At present, there is only one iterator for reading pariwise alignments: one
for repeat-masker alignments. This is the documentation for the iterator,
which describes the format, and the header-parsing function, which describes
the header format and mapping between the header columns and the above
meta-data keys.</p>
<p>Here is an example of a simple program that counts the number of alignments
in a repeat-masker alignment file</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyokit.io.alignmentIterators</span> <span class="kn">import</span> <span class="n">repeat_masker_alignment_iterator</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#from pyokit.datastruct import multipleAlignment</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alig_2_header</span> <span class="o">=</span> <span class="s">&quot;318 22.50 3.61 0.00 chr1 15266 15323 (249235276) C &quot;</span> <span class="o">+</span>\
<span class="gp">&gt;&gt;&gt; </span>                <span class="s">&quot;MIR3#SINE/MIR (65) 143 84 m_b1s601i1 5&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alig_2</span> <span class="o">=</span> <span class="s">&quot;  chr1          15266 GAAACT--GGCCCAGAGAGGTGAGGCAGCG 15293 </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>\
<span class="gp">&gt;&gt;&gt; </span>         <span class="s">&quot;                            --               i iii         </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>\
<span class="gp">&gt;&gt;&gt; </span>         <span class="s">&quot;C MIR3#SINE/MIR   143 GAAACTGAGGCCCAGAGAGGTGAAGTGACG 114   </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>\
<span class="gp">&gt;&gt;&gt; </span>         <span class="s">&quot;                                                           </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>\
<span class="gp">&gt;&gt;&gt; </span>         <span class="s">&quot;  chr1          15294 GGTCACAGAGCAAGGCAAAAGCGCGCTGGG 15323 </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>\
<span class="gp">&gt;&gt;&gt; </span>         <span class="s">&quot;                             v   ?  vi ivi    v            </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>\
<span class="gp">&gt;&gt;&gt; </span>         <span class="s">&quot;C MIR3#SINE/MIR   113 GGTCACACAGCKAGTTAGTGGCGAGCTGGG 84&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alig_2_m</span> <span class="o">=</span> <span class="s">&quot;Matrix = 25p47g.matrix                                   </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>\
<span class="gp">&gt;&gt;&gt; </span>           <span class="s">&quot;Kimura (with divCpGMod) = 26.25                          </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>\
<span class="gp">&gt;&gt;&gt; </span>           <span class="s">&quot;Transitions / transversions = 2.40 (12/5)                </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>\
<span class="gp">&gt;&gt;&gt; </span>           <span class="s">&quot;Gap_init rate = 0.03 (2 / 79), avg. gap size = 1.50 (3 / 2)&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alig_3_header</span> <span class="o">=</span> <span class="s">&quot;18 23.18 0.00 1.96 chr1 15798 15830 (249234772) &quot;</span> <span class="o">+</span>\
<span class="gp">&gt;&gt;&gt; </span>                <span class="s">&quot;(TGCTCC)n#Simple_repeat 1 32 (0) m_b1s252i0 6&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alig_3</span> <span class="o">=</span> <span class="s">&quot;  chr1          15798 GCTGCTTCTCCAGCTTTCGCTCCTTCATGCT 15828  </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>\
<span class="gp">&gt;&gt;&gt; </span>         <span class="s">&quot;                         v  v    v   iii      v - v          </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>\
<span class="gp">&gt;&gt;&gt; </span>         <span class="s">&quot;  (TGCTCC)n#Sim     1 GCTCCTGCTCCTGCTCCTGCTCCTGC-TCCT 30     </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>\
<span class="gp">&gt;&gt;&gt; </span>         <span class="s">&quot;                                                             </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>\
<span class="gp">&gt;&gt;&gt; </span>         <span class="s">&quot;  chr1          15829 GC 15830                               </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>\
<span class="gp">&gt;&gt;&gt; </span>         <span class="s">&quot;                                                             </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>\
<span class="gp">&gt;&gt;&gt; </span>         <span class="s">&quot;  (TGCTCC)n#Sim    31 GC 32                                    &quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">records</span> <span class="o">=</span> <span class="p">[</span><span class="n">alig_2_header</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="n">alig_2</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="n">alig_2_m</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>          <span class="n">alig_3_header</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="n">alig_3</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="n">alig_3_m</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_d</span> <span class="o">=</span> <span class="s">&quot;</span><span class="se">\n\n</span><span class="s">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">records</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span>
<span class="gp">&gt;&gt;&gt; </span>           <span class="n">repeat_masker_alignment_iterator</span><span class="p">(</span><span class="n">StringIO</span><span class="o">.</span><span class="n">StringIO</span><span class="p">(</span><span class="n">input_d</span><span class="p">))]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Sequence Alignments</a><ul>
<li><a class="reference internal" href="#pairwise-alignments">Pairwise alignments</a><ul>
<li><a class="reference internal" href="#pairwise-alignment-meta-data">Pairwise Alignment Meta-data</a></li>
<li><a class="reference internal" href="#reading-and-writing-pairwise-alignments">Reading and writing pairwise alignments</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="sequences.html"
                        title="previous chapter">Biological Sequences</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="retrotransposons.html"
                        title="next chapter">Retrotransposons</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/sequence_alignments.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="retrotransposons.html" title="Retrotransposons"
             >next</a> |</li>
        <li class="right" >
          <a href="sequences.html" title="Biological Sequences"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Pyokit 0.2.0 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="using.html" >Using Pyokit</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2014, Philip J. Uren.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.3.
    </div>
  </body>
</html>